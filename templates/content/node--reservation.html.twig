{#
/**
 * @file
 * Theme override for reservation nodes in full view mode.
 */
#}
<article{{ attributes.addClass('mh-reservation-page') }}>
  {{ title_prefix }}
  {% if not page %}
    <h2{{ title_attributes }}>
      <a href="{{ url }}" rel="bookmark">{{ label }}</a>
    </h2>
  {% else %}
    <h2{{ title_attributes.addClass('mh-reservation-page__title') }}>Reservations</h2>
  {% endif %}
  {{ title_suffix }}

  {% if reservation_page.overall %}
    <p class="mh-reservation-page__overall">
      <strong>Range / reservation instances:</strong> {{ reservation_page.overall.from }} to {{ reservation_page.overall.to }}
    </p>
  {% endif %}

  <section class="card mh-reservation-card mh-reservation-card--summary">
    <div class="card-header">
      <h2 class="card-title h4 mb-0">Reservation Summary</h2>
    </div>
    <div class="card-body">
      <ul class="mh-reservation-summary-metrics" aria-label="Reservation summary metrics">
        <li class="mh-reservation-summary-metric">
          <span class="mh-reservation-summary-metric__label">Status</span>
          <span class="mh-reservation-summary-metric__value">{{ reservation_page.status }}</span>
        </li>
        <li class="mh-reservation-summary-metric">
          <span class="mh-reservation-summary-metric__label">Purpose</span>
          <span class="mh-reservation-summary-metric__value">{{ reservation_page.purpose }}</span>
        </li>
        <li class="mh-reservation-summary-metric">
          <span class="mh-reservation-summary-metric__label">Sessions</span>
          <span class="mh-reservation-summary-metric__value">{{ reservation_page.sessions|length }}</span>
        </li>
        <li class="mh-reservation-summary-metric">
          <span class="mh-reservation-summary-metric__label">Assets</span>
          <span class="mh-reservation-summary-metric__value">{{ reservation_page.assets|length }}</span>
        </li>
        <li class="mh-reservation-summary-metric">
          <span class="mh-reservation-summary-metric__label">Cancelled</span>
          <span class="mh-reservation-summary-metric__value">{{ reservation_page.cancelled ? 'Yes' : 'No' }}</span>
        </li>
      </ul>
      {% if reservation_page.related_event %}
        <p class="mh-reservation-related-event mb-0">
          <span class="mh-reservation-related-event__label">Related Event:</span>
          <a href="{{ reservation_page.related_event.url }}">{{ reservation_page.related_event.event_title }}</a>
        </p>
      {% endif %}
    </div>
  </section>

  <section class="card mh-reservation-card">
    <div class="card-header">
      <h2 class="card-title h4 mb-0">Assets</h2>
    </div>
    <div class="card-body">
      {% if reservation_page.assets %}
        <ul class="mh-reservation-assets mh-reservation-assets--cards">
          {% for asset in reservation_page.assets %}
            <li class="mh-reservation-asset-row">
              {% if asset.image_url %}
                <a href="{{ asset.url }}" class="mh-reservation-asset-image-link">
                  <img
                    src="{{ asset.image_url }}"
                    alt="{{ asset.image_alt }}"
                    class="mh-reservation-asset-image"
                    loading="lazy"
                  >
                </a>
              {% endif %}
              <a href="{{ asset.url }}" class="mh-reservation-asset-title">{{ asset.title }}</a>
            </li>
          {% endfor %}
        </ul>
      {% else %}
        <p class="mb-0">No assets are linked.</p>
      {% endif %}
      {% if reservation_page.duplicate_assets_collapsed > 0 %}
        <p class="mh-reservation-dedupe-note mb-0">
          Duplicate assets hidden: {{ reservation_page.duplicate_assets_collapsed }}
        </p>
      {% endif %}
    </div>
  </section>

  <section class="card mh-reservation-card">
    <div class="card-header">
      <h2 class="card-title h4 mb-0">Reserved Sessions</h2>
    </div>
    <div class="card-body">
      {% if reservation_page.sessions %}
        <ol class="mh-reservation-sessions">
          {% for session in reservation_page.sessions %}
            <li class="mh-reservation-session-row">
              <span class="mh-reservation-session-date">{{ session.date_label }}</span>
              <span class="mh-reservation-session-time">{{ session.time_label }}</span>
            </li>
          {% endfor %}
        </ol>
      {% else %}
        <p class="mb-0">No sessions are set for this reservation.</p>
      {% endif %}
      {% if reservation_page.duplicate_sessions_collapsed > 0 %}
        <p class="mh-reservation-dedupe-note mb-0">
          Duplicate sessions hidden: {{ reservation_page.duplicate_sessions_collapsed }}
        </p>
      {% endif %}
    </div>
  </section>

  {% if reservation_page.notes %}
    <section class="card mh-reservation-card">
      <div class="card-header">
        <h2 class="card-title h4 mb-0">Reservation Notes</h2>
      </div>
      <div class="card-body">
        {{ reservation_page.notes }}
      </div>
    </section>
  {% endif %}
</article>
